<!DOCTYPE html>
<html>
<head>
    <title>ESP32 BLE Data</title>
</head>
<body>
    <h1>ESP32 BLE Data</h1>
    <button id="connect">Connect to ESP32</button>
    <div id="data">Data will appear here</div>

    <script>
        document.getElementById('connect').addEventListener('click', () => {
            let options = {
                filters: [{ services: ['4fafc201-1fb5-459e-8fcc-c5c9c331914b'] }]
            };

            navigator.bluetooth.requestDevice(options)
            .then(device => device.gatt.connect())
            .then(server => server.getPrimaryService('4fafc201-1fb5-459e-8fcc-c5c9c331914b'))
            .then(service => service.getCharacteristic('beb5483e-36e1-4688-b7f5-ea07361b26a8'))
            .then(characteristic => {
                return characteristic.startNotifications().then(_ => {
                    characteristic.addEventListener('characteristicvaluechanged', handleData);
                });
            })
            .catch(error => {
                console.log(error);
            });
        });

        function handleData(event) {
            console.log(event.target.value)
            // let value = new TextDecoder().decode(event.target.value);
            let value = event.target.value.getUint32();
            document.getElementById('data').innerText = value;
        }
    </script>
</body>
</html>