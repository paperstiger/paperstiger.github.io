<!DOCTYPE html>
<html>
<head>
    <title>ESP32 BLE Data</title>
</head>
<body>
    <h1>ESP32 BLE Data</h1>
    <button id="connect">Connect to ESP32</button>
    <div id="data">Data will appear here</div>

    <script>
        document.getElementById('connect').addEventListener('click', () => {
            let options = {
                filters: [{ services: [''] }]
            };

            navigator.bluetooth.requestDevice(options)
            .then(device => device.gatt.connect())
            .then(server => server.getPrimaryService('b9e91a27-c42a-4e9e-8852-69791238e8bd'))
            .then(service => service.getCharacteristic('80cff95a-1c91-400e-8ac2-471bba0621c3'))
            .then(characteristic => {
                return characteristic.startNotifications().then(_ => {
                    characteristic.addEventListener('characteristicvaluechanged', handleData);
                });
            })
            .catch(error => {
                console.log(error);
            });
        });

        function handleData(event) {
            let value = new TextDecoder().decode(event.target.value);
            document.getElementById('data').innerText = value;
        }
    </script>
</body>
</html>